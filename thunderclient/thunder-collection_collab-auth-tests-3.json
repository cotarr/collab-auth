{
    "client": "Thunder Client",
    "collectionName": "collab-auth-tests-3",
    "dateExported": "2024-01-09T20:05:30.213Z",
    "version": "1.1",
    "folders": [
        {
            "_id": "671a350d-aa39-4575-bf02-b5985c56c753",
            "name": "Authorization Code Parsing 1 of 2",
            "containerId": "",
            "created": "2023-10-26T15:49:26.927Z",
            "sortNum": 30000
        }
    ],
    "requests": [
        {
            "_id": "ce54dad5-53d9-42bb-baeb-6f36e0996121",
            "colId": "96ff2598-c93e-4171-b36a-57ea061c2fbc",
            "containerId": "671a350d-aa39-4575-bf02-b5985c56c753",
            "name": "/logout Clear variables",
            "url": "{{auth_host}}/logout",
            "method": "GET",
            "sortNum": 10000,
            "created": "2023-10-26T15:49:26.927Z",
            "modified": "2023-10-26T15:49:26.927Z",
            "headers": [
                {
                    "name": "Accept",
                    "value": "text/html"
                }
            ],
            "params": [],
            "tests": [
                {
                    "type": "res-code",
                    "custom": "",
                    "action": "equal",
                    "value": "200"
                },
                {
                    "type": "res-body",
                    "custom": "",
                    "action": "contains",
                    "value": "You have been logged out of the authorization server."
                },
                {
                    "type": "set-env-var",
                    "custom": "delete",
                    "action": "setto",
                    "value": "{{access_token, local}}"
                },
                {
                    "type": "set-env-var",
                    "custom": "delete",
                    "action": "setto",
                    "value": "{{refresh_token, local}}"
                },
                {
                    "type": "set-env-var",
                    "custom": "delete",
                    "action": "setto",
                    "value": "{{csrf_token, local}}"
                },
                {
                    "type": "set-env-var",
                    "custom": "delete",
                    "action": "setto",
                    "value": "{{transaction_id, local}}"
                },
                {
                    "type": "set-env-var",
                    "custom": "delete",
                    "action": "setto",
                    "value": "{{auth_code, local}}"
                },
                {
                    "type": "set-env-var",
                    "custom": "delete",
                    "action": "setto",
                    "value": "{{user_uuid, local}}"
                },
                {
                    "type": "set-env-var",
                    "custom": "delete",
                    "action": "setto",
                    "value": "{{client_uuid, local}}"
                }
            ],
            "preReq": {
                "options": {
                    "clearCookies": true
                }
            }
        },
        {
            "_id": "df674bca-bfc5-45d1-8e26-50d3d1b853e9",
            "colId": "96ff2598-c93e-4171-b36a-57ea061c2fbc",
            "containerId": "671a350d-aa39-4575-bf02-b5985c56c753",
            "name": "/dialog/authorize Authorization check 1",
            "url": "{{auth_host}}/dialog/authorize?redirect_uri={{redirect_uri}}&response_type=code&client_id={{client_id}}&scope={{scopes}}",
            "method": "GET",
            "sortNum": 12500,
            "created": "2023-10-26T15:49:26.929Z",
            "modified": "2023-10-26T15:49:26.929Z",
            "headers": [
                {
                    "name": "Accept",
                    "value": "text/html"
                }
            ],
            "params": [
                {
                    "name": "redirect_uri",
                    "value": "{{redirect_uri}}",
                    "isPath": false
                },
                {
                    "name": "response_type",
                    "value": "code",
                    "isPath": false
                },
                {
                    "name": "client_id",
                    "value": "{{client_id}}",
                    "isPath": false
                },
                {
                    "name": "scope",
                    "value": "{{scopes}}",
                    "isPath": false
                }
            ],
            "tests": [
                {
                    "type": "res-code",
                    "custom": "",
                    "action": "equal",
                    "value": "302"
                },
                {
                    "type": "custom-header",
                    "custom": "location",
                    "action": "equal",
                    "value": "/login"
                }
            ]
        },
        {
            "_id": "48715e9e-5100-4130-a6cc-be53c30f0173",
            "colId": "96ff2598-c93e-4171-b36a-57ea061c2fbc",
            "containerId": "671a350d-aa39-4575-bf02-b5985c56c753",
            "name": "/login Get login form",
            "url": "{{auth_host}}/login",
            "method": "GET",
            "sortNum": 20000,
            "created": "2023-10-26T15:49:26.928Z",
            "modified": "2023-10-26T15:49:26.928Z",
            "headers": [
                {
                    "name": "Accept",
                    "value": "text/html"
                }
            ],
            "params": [],
            "tests": [
                {
                    "type": "res-code",
                    "custom": "",
                    "action": "equal",
                    "value": "200"
                },
                {
                    "type": "res-body",
                    "custom": "",
                    "action": "contains",
                    "value": "User Login"
                },
                {
                    "type": "res-body",
                    "custom": "",
                    "action": "contains",
                    "value": "_csrf"
                },
                {
                    "type": "set-env-var",
                    "custom": "text | removeQuotes | split(\"name=_csrf\" | at(1) | split(\"value=\" | at(1) | split(\">\") | first ",
                    "action": "setto",
                    "value": "{{csrf_token, local}}"
                }
            ]
        },
        {
            "_id": "a8539aee-589b-4934-a029-7e42fbdcdd81",
            "colId": "96ff2598-c93e-4171-b36a-57ea061c2fbc",
            "containerId": "671a350d-aa39-4575-bf02-b5985c56c753",
            "name": "/login Submit username and password",
            "url": "{{auth_host}}/login",
            "method": "POST",
            "sortNum": 25000,
            "created": "2023-10-26T15:49:26.930Z",
            "modified": "2023-10-26T15:49:26.930Z",
            "headers": [
                {
                    "name": "Accept",
                    "value": "text/html"
                }
            ],
            "params": [],
            "body": {
                "type": "formencoded",
                "raw": "",
                "form": [
                    {
                        "name": "username",
                        "value": "{{user_username}}"
                    },
                    {
                        "name": "password",
                        "value": "{{user_password}}"
                    },
                    {
                        "name": "_csrf",
                        "value": "{{csrf_token}}"
                    }
                ]
            },
            "tests": [
                {
                    "type": "res-code",
                    "custom": "",
                    "action": "equal",
                    "value": "302"
                },
                {
                    "type": "custom-header",
                    "custom": "location | split(\"?\") | first",
                    "action": "equal",
                    "value": "/dialog/authorize"
                },
                {
                    "type": "custom-header",
                    "custom": "location",
                    "action": "contains",
                    "value": "response_type=code"
                },
                {
                    "type": "custom-header",
                    "custom": "location",
                    "action": "contains",
                    "value": "client_id={{client_id}}"
                },
                {
                    "type": "custom-header",
                    "custom": "location",
                    "action": "contains",
                    "value": "scope="
                }
            ]
        },
        {
            "_id": "54f03b3b-aed9-44dd-86fd-bc84aa2bf8d2",
            "colId": "96ff2598-c93e-4171-b36a-57ea061c2fbc",
            "containerId": "671a350d-aa39-4575-bf02-b5985c56c753",
            "name": "/dialog/authorize  get transaction_id 1",
            "url": "{{auth_host}}/dialog/authorize?redirect_uri={{redirect_uri}}&response_type=code&client_id={{client_id}}&scope={{scopes}}",
            "method": "GET",
            "sortNum": 40000,
            "created": "2023-10-26T15:49:26.932Z",
            "modified": "2023-10-26T15:49:26.932Z",
            "headers": [
                {
                    "name": "Accept",
                    "value": "text/html"
                }
            ],
            "params": [
                {
                    "name": "redirect_uri",
                    "value": "{{redirect_uri}}",
                    "isPath": false
                },
                {
                    "name": "response_type",
                    "value": "code",
                    "isPath": false
                },
                {
                    "name": "client_id",
                    "value": "{{client_id}}",
                    "isPath": false
                },
                {
                    "name": "scope",
                    "value": "{{scopes}}",
                    "isPath": false
                }
            ],
            "tests": [
                {
                    "type": "res-code",
                    "custom": "",
                    "action": "equal",
                    "value": "200"
                },
                {
                    "type": "res-body",
                    "custom": "",
                    "action": "contains",
                    "value": "Resource Decision"
                },
                {
                    "type": "set-env-var",
                    "custom": "text | removeQuotes | split(\"name=_csrf\" | at(1) | split(\"value=\" | at(1) | split(\">\") | first ",
                    "action": "setto",
                    "value": "{{csrf_token, local}}"
                },
                {
                    "type": "set-env-var",
                    "custom": "text | removeQuotes | split(\"name=transaction_id\" | at(1) | split(\"value=\") | at(1) | split(\">\") | first",
                    "action": "setto",
                    "value": "{{transaction_id, local}}"
                }
            ]
        },
        {
            "_id": "87f23f28-1361-493c-a2fe-2bc4c95d80fb",
            "colId": "96ff2598-c93e-4171-b36a-57ea061c2fbc",
            "containerId": "671a350d-aa39-4575-bf02-b5985c56c753",
            "name": "/dialog/authorize/decision get auth code 1",
            "url": "{{auth_host}}/dialog/authorize/decision",
            "method": "POST",
            "sortNum": 45000,
            "created": "2023-10-26T15:49:26.931Z",
            "modified": "2023-10-26T15:49:26.931Z",
            "headers": [
                {
                    "name": "Accept",
                    "value": "text/html"
                }
            ],
            "params": [],
            "body": {
                "type": "formencoded",
                "raw": "",
                "form": [
                    {
                        "name": "transaction_id",
                        "value": "{{transaction_id}}"
                    },
                    {
                        "name": "_csrf",
                        "value": "{{csrf_token}}"
                    },
                    {
                        "name": "cancel",
                        "value": "Deny",
                        "isDisabled": true
                    }
                ]
            },
            "tests": [
                {
                    "type": "res-code",
                    "custom": "",
                    "action": "equal",
                    "value": "302"
                },
                {
                    "type": "custom-header",
                    "custom": "location | split(\"?\") | first",
                    "action": "equal",
                    "value": "{{redirect_uri}}"
                },
                {
                    "type": "custom-header",
                    "custom": "location",
                    "action": "contains",
                    "value": "code="
                },
                {
                    "type": "set-env-var",
                    "custom": "header.location | split(\"code=\") | last",
                    "action": "setto",
                    "value": "{{auth_code, local}}"
                }
            ]
        },
        {
            "_id": "d37f6759-91dd-4475-ab08-5b57e2b645b3",
            "colId": "96ff2598-c93e-4171-b36a-57ea061c2fbc",
            "containerId": "671a350d-aa39-4575-bf02-b5985c56c753",
            "name": "100 /oauth/token Fail: Extraneous properties in body",
            "url": "{{auth_host}}/oauth/token",
            "method": "POST",
            "sortNum": 50000,
            "created": "2023-10-26T15:49:26.933Z",
            "modified": "2023-10-26T15:49:26.933Z",
            "headers": [
                {
                    "name": "Accept",
                    "value": "application/json"
                }
            ],
            "params": [],
            "body": {
                "type": "json",
                "raw": "{\n  \"code\": \"{{auth_code}}\",\n  \"redirect_uri\": \"{{redirect_uri}}\",\n  \"client_id\": \"{{client_id}}\",\n  \"client_secret\": \"{{client_secret}}\",\n  \"grant_type\": \"authorization_code\",\n  \"extraneious\": \"Invalid value for test\"\n}",
                "form": []
            },
            "tests": [
                {
                    "type": "res-code",
                    "custom": "",
                    "action": "equal",
                    "value": "400"
                },
                {
                    "type": "json-query",
                    "custom": "json.errors[0].msg",
                    "action": "equal",
                    "value": "Invalid param"
                }
            ]
        },
        {
            "_id": "47a34939-05b0-4ffe-bb24-c0ebe9b4c5aa",
            "colId": "96ff2598-c93e-4171-b36a-57ea061c2fbc",
            "containerId": "671a350d-aa39-4575-bf02-b5985c56c753",
            "name": "101 /oauth/token Fail: body is text (text/plain)",
            "url": "{{auth_host}}/oauth/token",
            "method": "POST",
            "sortNum": 52500,
            "created": "2023-10-26T15:49:26.934Z",
            "modified": "2023-10-26T15:49:26.934Z",
            "headers": [
                {
                    "name": "Accept",
                    "value": "application/json"
                },
                {
                    "name": "Content-Type",
                    "value": "text/plain"
                }
            ],
            "params": [],
            "body": {
                "type": "text",
                "raw": "This is some random text",
                "form": []
            },
            "tests": [
                {
                    "type": "res-code",
                    "custom": "",
                    "action": "equal",
                    "value": "401"
                }
            ]
        },
        {
            "_id": "5441abed-52bc-4d04-b831-b812961f9e80",
            "colId": "96ff2598-c93e-4171-b36a-57ea061c2fbc",
            "containerId": "671a350d-aa39-4575-bf02-b5985c56c753",
            "name": "102 /oauth/token Fail: body is text (application/json)",
            "url": "{{auth_host}}/oauth/token",
            "method": "POST",
            "sortNum": 53750,
            "created": "2023-10-26T15:49:26.935Z",
            "modified": "2023-10-26T15:49:26.935Z",
            "headers": [
                {
                    "name": "Accept",
                    "value": "application/json"
                },
                {
                    "name": "Content-Type",
                    "value": "application/json"
                }
            ],
            "params": [],
            "body": {
                "type": "text",
                "raw": "This is some random text",
                "form": []
            },
            "tests": [
                {
                    "type": "res-code",
                    "custom": "",
                    "action": "equal",
                    "value": "400"
                },
                {
                    "type": "res-body",
                    "custom": "",
                    "action": "contains",
                    "value": "in JSON at position"
                }
            ]
        },
        {
            "_id": "26198390-c415-41fe-81b8-8da4b16fc5ed",
            "colId": "96ff2598-c93e-4171-b36a-57ea061c2fbc",
            "containerId": "671a350d-aa39-4575-bf02-b5985c56c753",
            "name": "103 /oauth/token Fail: JSON missing end brace",
            "url": "{{auth_host}}/oauth/token",
            "method": "POST",
            "sortNum": 54375,
            "created": "2023-10-26T15:49:26.936Z",
            "modified": "2023-10-26T15:49:26.936Z",
            "headers": [
                {
                    "name": "Accept",
                    "value": "application/json"
                },
                {
                    "name": "Content-Type",
                    "value": "application/json"
                }
            ],
            "params": [],
            "body": {
                "type": "json",
                "raw": "{\n  \"code\": \"{{auth_code}}\",\n  \"redirect_uri\": \"{{redirect_uri}}\",\n  \"client_id\": \"{{client_id}}\",\n  \"client_secret\": \"{{client_secret}}\",\n  \"grant_type\": \"authorization_code\"\n",
                "form": []
            },
            "tests": [
                {
                    "type": "res-code",
                    "custom": "",
                    "action": "equal",
                    "value": "400"
                },
                {
                    "type": "res-body",
                    "custom": "",
                    "action": "contains",
                    "value": "Unexpected end of JSON input"
                }
            ]
        },
        {
            "_id": "2fb6ee4a-086d-428c-b01d-9e8a2af15e85",
            "colId": "96ff2598-c93e-4171-b36a-57ea061c2fbc",
            "containerId": "671a350d-aa39-4575-bf02-b5985c56c753",
            "name": "/oauth/token Expect Success 2",
            "url": "{{auth_host}}/oauth/token",
            "method": "POST",
            "sortNum": 54472.8,
            "created": "2023-10-26T15:49:26.951Z",
            "modified": "2023-10-26T15:49:26.951Z",
            "headers": [
                {
                    "name": "Accept",
                    "value": "application/json"
                }
            ],
            "params": [],
            "body": {
                "type": "json",
                "raw": "{\n  \"code\": \"{{auth_code}}\",\n  \"redirect_uri\": \"{{redirect_uri}}\",\n  \"client_id\": \"{{client_id}}\",\n  \"client_secret\": \"{{client_secret}}\",\n  \"grant_type\": \"authorization_code\"\n}",
                "form": []
            },
            "tests": [
                {
                    "type": "res-code",
                    "custom": "",
                    "action": "equal",
                    "value": "200"
                },
                {
                    "type": "json-query",
                    "custom": "json.grant_type",
                    "action": "equal",
                    "value": "authorization_code"
                },
                {
                    "type": "json-query",
                    "custom": "json.token_type | lower",
                    "action": "equal",
                    "value": "bearer"
                },
                {
                    "type": "json-query",
                    "custom": "json.access_token | length",
                    "action": ">",
                    "value": "0"
                },
                {
                    "type": "json-query",
                    "custom": "json.refresh_token | length",
                    "action": ">",
                    "value": "0"
                }
            ]
        },
        {
            "_id": "00dce0aa-e022-4a8e-9780-41280c21ceef",
            "colId": "96ff2598-c93e-4171-b36a-57ea061c2fbc",
            "containerId": "671a350d-aa39-4575-bf02-b5985c56c753",
            "name": "/dialog/authorize  refresh transaction_id 2",
            "url": "{{auth_host}}/dialog/authorize?redirect_uri={{redirect_uri}}&response_type=code&client_id={{client_id}}&scope={{scopes}}",
            "method": "GET",
            "sortNum": 54502.1,
            "created": "2023-10-26T15:49:26.952Z",
            "modified": "2023-10-26T15:49:26.952Z",
            "headers": [
                {
                    "name": "Accept",
                    "value": "text/html"
                }
            ],
            "params": [
                {
                    "name": "redirect_uri",
                    "value": "{{redirect_uri}}",
                    "isPath": false
                },
                {
                    "name": "response_type",
                    "value": "code",
                    "isPath": false
                },
                {
                    "name": "client_id",
                    "value": "{{client_id}}",
                    "isPath": false
                },
                {
                    "name": "scope",
                    "value": "{{scopes}}",
                    "isPath": false
                }
            ],
            "tests": [
                {
                    "type": "res-code",
                    "custom": "",
                    "action": "equal",
                    "value": "200"
                },
                {
                    "type": "res-body",
                    "custom": "",
                    "action": "contains",
                    "value": "Resource Decision"
                },
                {
                    "type": "set-env-var",
                    "custom": "text | removeQuotes | split(\"name=_csrf\" | at(1) | split(\"value=\" | at(1) | split(\">\") | first ",
                    "action": "setto",
                    "value": "{{csrf_token, local}}"
                },
                {
                    "type": "set-env-var",
                    "custom": "text | removeQuotes | split(\"name=transaction_id\" | at(1) | split(\"value=\") | at(1) | split(\">\") | first",
                    "action": "setto",
                    "value": "{{transaction_id, local}}"
                }
            ]
        },
        {
            "_id": "e701b2b0-f699-4df2-9951-a9ba74c2be45",
            "colId": "96ff2598-c93e-4171-b36a-57ea061c2fbc",
            "containerId": "671a350d-aa39-4575-bf02-b5985c56c753",
            "name": "/dialog/authorize/decision Get another auth code 2",
            "url": "{{auth_host}}/dialog/authorize/decision",
            "method": "POST",
            "sortNum": 54516.7,
            "created": "2023-10-26T15:49:26.953Z",
            "modified": "2023-10-26T15:49:26.953Z",
            "headers": [
                {
                    "name": "Accept",
                    "value": "text/html"
                }
            ],
            "params": [],
            "body": {
                "type": "formencoded",
                "raw": "",
                "form": [
                    {
                        "name": "transaction_id",
                        "value": "{{transaction_id}}"
                    },
                    {
                        "name": "_csrf",
                        "value": "{{csrf_token}}"
                    },
                    {
                        "name": "cancel",
                        "value": "Deny",
                        "isDisabled": true
                    }
                ]
            },
            "tests": [
                {
                    "type": "res-code",
                    "custom": "",
                    "action": "equal",
                    "value": "302"
                },
                {
                    "type": "custom-header",
                    "custom": "location | split(\"?\") | first",
                    "action": "equal",
                    "value": "{{redirect_uri}}"
                },
                {
                    "type": "custom-header",
                    "custom": "location",
                    "action": "contains",
                    "value": "code="
                },
                {
                    "type": "set-env-var",
                    "custom": "header.location | split(\"code=\") | last",
                    "action": "setto",
                    "value": "{{auth_code, local}}"
                }
            ]
        },
        {
            "_id": "a3ed3f3e-7327-424f-9bc7-0e51792f7fa3",
            "colId": "96ff2598-c93e-4171-b36a-57ea061c2fbc",
            "containerId": "671a350d-aa39-4575-bf02-b5985c56c753",
            "name": "110 /oauth/token Fail Missing client_id",
            "url": "{{auth_host}}/oauth/token",
            "method": "POST",
            "sortNum": 54523.8,
            "created": "2023-10-26T15:49:26.937Z",
            "modified": "2023-10-26T15:49:26.937Z",
            "headers": [
                {
                    "name": "Accept",
                    "value": "application/json"
                }
            ],
            "params": [],
            "body": {
                "type": "json",
                "raw": "{\n  \"code\": \"{{auth_code}}\",\n  \"redirect_uri\": \"{{redirect_uri}}\",\n  \"client_secret\": \"{{client_secret}}\",\n  \"grant_type\": \"authorization_code\"\n}",
                "form": []
            },
            "tests": [
                {
                    "type": "res-code",
                    "custom": "",
                    "action": "equal",
                    "value": "401"
                }
            ]
        },
        {
            "_id": "1c1d0621-db46-4a22-b272-fd986ce3ebf2",
            "colId": "96ff2598-c93e-4171-b36a-57ea061c2fbc",
            "containerId": "671a350d-aa39-4575-bf02-b5985c56c753",
            "name": "112 /oauth/token Fail empty string client_id",
            "url": "{{auth_host}}/oauth/token",
            "method": "POST",
            "sortNum": 54530.9,
            "created": "2023-10-26T15:49:26.938Z",
            "modified": "2023-10-26T15:49:26.938Z",
            "headers": [
                {
                    "name": "Accept",
                    "value": "application/json"
                }
            ],
            "params": [],
            "body": {
                "type": "json",
                "raw": "{\n  \"code\": \"{{auth_code}}\",\n  \"redirect_uri\": \"{{redirect_uri}}\",\n  \"client_id\": \"\",\n  \"client_secret\": \"{{client_secret}}\",\n  \"grant_type\": \"authorization_code\"\n}",
                "form": []
            },
            "tests": [
                {
                    "type": "res-code",
                    "custom": "",
                    "action": "equal",
                    "value": "401"
                }
            ]
        },
        {
            "_id": "e9050949-7f34-4b6b-97fe-aa3e04737924",
            "colId": "96ff2598-c93e-4171-b36a-57ea061c2fbc",
            "containerId": "671a350d-aa39-4575-bf02-b5985c56c753",
            "name": "111 /oauth/token Fail Missing client_secret",
            "url": "{{auth_host}}/oauth/token",
            "method": "POST",
            "sortNum": 54530.9,
            "created": "2023-10-26T15:49:26.939Z",
            "modified": "2023-10-26T15:49:26.939Z",
            "headers": [
                {
                    "name": "Accept",
                    "value": "application/json"
                }
            ],
            "params": [],
            "body": {
                "type": "json",
                "raw": "{\n  \"code\": \"{{auth_code}}\",\n  \"redirect_uri\": \"{{redirect_uri}}\",\n  \"client_id\": \"{{client_id}}\",\n  \"grant_type\": \"authorization_code\"\n}",
                "form": []
            },
            "tests": [
                {
                    "type": "res-code",
                    "custom": "",
                    "action": "equal",
                    "value": "401"
                }
            ]
        },
        {
            "_id": "68633c32-1021-404d-9594-af77d49fdf22",
            "colId": "96ff2598-c93e-4171-b36a-57ea061c2fbc",
            "containerId": "671a350d-aa39-4575-bf02-b5985c56c753",
            "name": "113 /oauth/token Fail empty string client_secret",
            "url": "{{auth_host}}/oauth/token",
            "method": "POST",
            "sortNum": 54530.9,
            "created": "2023-10-26T15:49:26.940Z",
            "modified": "2023-10-26T15:49:26.940Z",
            "headers": [
                {
                    "name": "Accept",
                    "value": "application/json"
                }
            ],
            "params": [],
            "body": {
                "type": "json",
                "raw": "{\n  \"code\": \"{{auth_code}}\",\n  \"redirect_uri\": \"{{redirect_uri}}\",\n  \"client_id\": \"{{client_id}}\",\n  \"client_secret\": \"\",\n  \"grant_type\": \"authorization_code\"\n}",
                "form": []
            },
            "tests": [
                {
                    "type": "res-code",
                    "custom": "",
                    "action": "equal",
                    "value": "401"
                }
            ]
        },
        {
            "_id": "15f3849f-ff56-4eee-8ee5-a530103729e1",
            "colId": "96ff2598-c93e-4171-b36a-57ea061c2fbc",
            "containerId": "671a350d-aa39-4575-bf02-b5985c56c753",
            "name": "/oauth/token Expect Success 3",
            "url": "{{auth_host}}/oauth/token",
            "method": "POST",
            "sortNum": 54531.2,
            "created": "2023-10-26T15:49:26.973Z",
            "modified": "2023-10-26T15:49:26.973Z",
            "headers": [
                {
                    "name": "Accept",
                    "value": "application/json"
                }
            ],
            "params": [],
            "body": {
                "type": "json",
                "raw": "{\n  \"code\": \"{{auth_code}}\",\n  \"redirect_uri\": \"{{redirect_uri}}\",\n  \"client_id\": \"{{client_id}}\",\n  \"client_secret\": \"{{client_secret}}\",\n  \"grant_type\": \"authorization_code\"\n}",
                "form": []
            },
            "tests": [
                {
                    "type": "res-code",
                    "custom": "",
                    "action": "equal",
                    "value": "200"
                },
                {
                    "type": "json-query",
                    "custom": "json.grant_type",
                    "action": "equal",
                    "value": "authorization_code"
                },
                {
                    "type": "json-query",
                    "custom": "json.token_type | lower",
                    "action": "equal",
                    "value": "bearer"
                },
                {
                    "type": "json-query",
                    "custom": "json.access_token | length",
                    "action": ">",
                    "value": "0"
                },
                {
                    "type": "json-query",
                    "custom": "json.refresh_token | length",
                    "action": ">",
                    "value": "0"
                }
            ]
        },
        {
            "_id": "c4106dee-8ee8-4d7a-8e18-9b40d9aeeaf9",
            "colId": "96ff2598-c93e-4171-b36a-57ea061c2fbc",
            "containerId": "671a350d-aa39-4575-bf02-b5985c56c753",
            "name": "120 /oauth/token Fail Missing auth code",
            "url": "{{auth_host}}/oauth/token",
            "method": "POST",
            "sortNum": 54531.3,
            "created": "2023-10-26T15:49:26.942Z",
            "modified": "2023-10-26T15:49:26.942Z",
            "headers": [
                {
                    "name": "Accept",
                    "value": "application/json"
                }
            ],
            "params": [],
            "body": {
                "type": "json",
                "raw": "{\n  \"redirect_uri\": \"{{redirect_uri}}\",\n  \"client_id\": \"{{client_id}}\",\n  \"client_secret\": \"{{client_secret}}\",\n  \"grant_type\": \"authorization_code\"\n}",
                "form": []
            },
            "tests": [
                {
                    "type": "res-code",
                    "custom": "",
                    "action": "equal",
                    "value": "400"
                }
            ]
        },
        {
            "_id": "ce07a461-1a69-4dfc-98b0-a6670448dde7",
            "colId": "96ff2598-c93e-4171-b36a-57ea061c2fbc",
            "containerId": "671a350d-aa39-4575-bf02-b5985c56c753",
            "name": "121 /oauth/token Fail Missing grant_type",
            "url": "{{auth_host}}/oauth/token",
            "method": "POST",
            "sortNum": 54531.3,
            "created": "2023-10-26T15:49:26.943Z",
            "modified": "2023-10-26T15:49:26.943Z",
            "headers": [
                {
                    "name": "Accept",
                    "value": "application/json"
                }
            ],
            "params": [],
            "body": {
                "type": "json",
                "raw": "{\n  \"code\": \"{{auth_code}}\",\n  \"redirect_uri\": \"{{redirect_uri}}\",\n  \"client_id\": \"{{client_id}}\",\n  \"client_secret\": \"{{client_secret}}\"\n}",
                "form": []
            },
            "tests": [
                {
                    "type": "res-code",
                    "custom": "",
                    "action": "equal",
                    "value": "400"
                }
            ]
        },
        {
            "_id": "135f32cf-8bea-4aa4-ae8c-d3c3b99475b8",
            "colId": "96ff2598-c93e-4171-b36a-57ea061c2fbc",
            "containerId": "671a350d-aa39-4575-bf02-b5985c56c753",
            "name": "122 /oauth/token Fail empty string auth code",
            "url": "{{auth_host}}/oauth/token",
            "method": "POST",
            "sortNum": 54531.3,
            "created": "2023-10-26T15:49:26.944Z",
            "modified": "2023-10-26T15:49:26.944Z",
            "headers": [
                {
                    "name": "Accept",
                    "value": "application/json"
                }
            ],
            "params": [],
            "body": {
                "type": "json",
                "raw": "{\n  \"code\": \"\",\n  \"redirect_uri\": \"{{redirect_uri}}\",\n  \"client_id\": \"{{client_id}}\",\n  \"client_secret\": \"{{client_secret}}\",\n  \"grant_type\": \"authorization_code\"\n}",
                "form": []
            },
            "tests": [
                {
                    "type": "res-code",
                    "custom": "",
                    "action": "equal",
                    "value": "400"
                }
            ]
        },
        {
            "_id": "57748d87-a86c-4b03-a587-e8958a6b70ae",
            "colId": "96ff2598-c93e-4171-b36a-57ea061c2fbc",
            "containerId": "671a350d-aa39-4575-bf02-b5985c56c753",
            "name": "123 /oauth/token Fail empty string grant type",
            "url": "{{auth_host}}/oauth/token",
            "method": "POST",
            "sortNum": 54531.3,
            "created": "2023-10-26T15:49:26.946Z",
            "modified": "2023-10-26T15:49:26.946Z",
            "headers": [
                {
                    "name": "Accept",
                    "value": "application/json"
                }
            ],
            "params": [],
            "body": {
                "type": "json",
                "raw": "{\n  \"code\": \"{{auth_code}}\",\n  \"redirect_uri\": \"{{redirect_uri}}\",\n  \"client_id\": \"{{client_id}}\",\n  \"client_secret\": \"{{client_secret}}\",\n  \"grant_type\": \"\"\n}",
                "form": []
            },
            "tests": [
                {
                    "type": "res-code",
                    "custom": "",
                    "action": "equal",
                    "value": "400"
                }
            ]
        },
        {
            "_id": "20d97ac0-8d15-45ad-b622-4f92d778809a",
            "colId": "96ff2598-c93e-4171-b36a-57ea061c2fbc",
            "containerId": "671a350d-aa39-4575-bf02-b5985c56c753",
            "name": "124 /oauth/token Fail modified value auth code",
            "url": "{{auth_host}}/oauth/token",
            "method": "POST",
            "sortNum": 54531.3,
            "created": "2023-10-26T15:49:26.947Z",
            "modified": "2023-10-26T15:49:26.947Z",
            "headers": [
                {
                    "name": "Accept",
                    "value": "application/json"
                }
            ],
            "params": [],
            "body": {
                "type": "json",
                "raw": "{\n  \"code\": \"{{auth_code}}x\",\n  \"redirect_uri\": \"{{redirect_uri}}\",\n  \"client_id\": \"{{client_id}}\",\n  \"client_secret\": \"{{client_secret}}\",\n  \"grant_type\": \"authorization_code\"\n}",
                "form": []
            },
            "tests": [
                {
                    "type": "res-code",
                    "custom": "",
                    "action": "equal",
                    "value": "403"
                }
            ]
        },
        {
            "_id": "0fc7a242-da85-41bd-b227-17e0c7e84935",
            "colId": "96ff2598-c93e-4171-b36a-57ea061c2fbc",
            "containerId": "671a350d-aa39-4575-bf02-b5985c56c753",
            "name": "130 /oauth/token Fail modified value client id",
            "url": "{{auth_host}}/oauth/token",
            "method": "POST",
            "sortNum": 54531.3,
            "created": "2023-10-26T15:49:26.949Z",
            "modified": "2023-10-26T15:49:26.949Z",
            "headers": [
                {
                    "name": "Accept",
                    "value": "application/json"
                }
            ],
            "params": [],
            "body": {
                "type": "json",
                "raw": "{\n  \"code\": \"{{auth_code}}\",\n  \"redirect_uri\": \"{{redirect_uri}}\",\n  \"client_id\": \"{{client_id}}x\",\n  \"client_secret\": \"{{client_secret}}\",\n  \"grant_type\": \"\"\n}",
                "form": []
            },
            "tests": [
                {
                    "type": "res-code",
                    "custom": "",
                    "action": "equal",
                    "value": "401"
                }
            ]
        },
        {
            "_id": "e9f5a542-7150-4689-beda-aa60b997ed04",
            "colId": "96ff2598-c93e-4171-b36a-57ea061c2fbc",
            "containerId": "671a350d-aa39-4575-bf02-b5985c56c753",
            "name": "125 /oauth/token Fail modified value grant_type",
            "url": "{{auth_host}}/oauth/token",
            "method": "POST",
            "sortNum": 54531.3,
            "created": "2023-10-26T15:49:26.950Z",
            "modified": "2023-10-26T15:49:26.950Z",
            "headers": [
                {
                    "name": "Accept",
                    "value": "application/json"
                }
            ],
            "params": [],
            "body": {
                "type": "json",
                "raw": "{\n  \"code\": \"{{auth_code}}\",\n  \"redirect_uri\": \"{{redirect_uri}}\",\n  \"client_id\": \"{{client_id}}\",\n  \"client_secret\": \"{{client_secret}}\",\n  \"grant_type\": \"authorization_codex\"\n}",
                "form": []
            },
            "tests": [
                {
                    "type": "res-code",
                    "custom": "",
                    "action": "equal",
                    "value": "400"
                }
            ]
        },
        {
            "_id": "8882f85c-f051-4a55-b39e-aac98ba952a8",
            "colId": "96ff2598-c93e-4171-b36a-57ea061c2fbc",
            "containerId": "671a350d-aa39-4575-bf02-b5985c56c753",
            "name": "/dialog/authorize  refresh transaction_id 4",
            "url": "{{auth_host}}/dialog/authorize?redirect_uri={{redirect_uri}}&response_type=code&client_id={{client_id}}&scope={{scopes}}",
            "method": "GET",
            "sortNum": 54531.3,
            "created": "2023-10-26T15:49:26.954Z",
            "modified": "2023-10-26T15:49:26.954Z",
            "headers": [
                {
                    "name": "Accept",
                    "value": "text/html"
                }
            ],
            "params": [
                {
                    "name": "redirect_uri",
                    "value": "{{redirect_uri}}",
                    "isPath": false
                },
                {
                    "name": "response_type",
                    "value": "code",
                    "isPath": false
                },
                {
                    "name": "client_id",
                    "value": "{{client_id}}",
                    "isPath": false
                },
                {
                    "name": "scope",
                    "value": "{{scopes}}",
                    "isPath": false
                }
            ],
            "tests": [
                {
                    "type": "res-code",
                    "custom": "",
                    "action": "equal",
                    "value": "200"
                },
                {
                    "type": "res-body",
                    "custom": "",
                    "action": "contains",
                    "value": "Resource Decision"
                },
                {
                    "type": "set-env-var",
                    "custom": "text | removeQuotes | split(\"name=_csrf\" | at(1) | split(\"value=\" | at(1) | split(\">\") | first ",
                    "action": "setto",
                    "value": "{{csrf_token, local}}"
                },
                {
                    "type": "set-env-var",
                    "custom": "text | removeQuotes | split(\"name=transaction_id\" | at(1) | split(\"value=\") | at(1) | split(\">\") | first",
                    "action": "setto",
                    "value": "{{transaction_id, local}}"
                }
            ]
        },
        {
            "_id": "e0928899-c045-4e5f-ab53-973a6e6f1b3d",
            "colId": "96ff2598-c93e-4171-b36a-57ea061c2fbc",
            "containerId": "671a350d-aa39-4575-bf02-b5985c56c753",
            "name": "/dialog/authorize/decision Get another auth code 4",
            "url": "{{auth_host}}/dialog/authorize/decision",
            "method": "POST",
            "sortNum": 54531.3,
            "created": "2023-10-26T15:49:26.955Z",
            "modified": "2023-10-26T15:49:26.955Z",
            "headers": [
                {
                    "name": "Accept",
                    "value": "text/html"
                }
            ],
            "params": [],
            "body": {
                "type": "formencoded",
                "raw": "",
                "form": [
                    {
                        "name": "transaction_id",
                        "value": "{{transaction_id}}"
                    },
                    {
                        "name": "_csrf",
                        "value": "{{csrf_token}}"
                    },
                    {
                        "name": "cancel",
                        "value": "Deny",
                        "isDisabled": true
                    }
                ]
            },
            "tests": [
                {
                    "type": "res-code",
                    "custom": "",
                    "action": "equal",
                    "value": "302"
                },
                {
                    "type": "custom-header",
                    "custom": "location | split(\"?\") | first",
                    "action": "equal",
                    "value": "{{redirect_uri}}"
                },
                {
                    "type": "custom-header",
                    "custom": "location",
                    "action": "contains",
                    "value": "code="
                },
                {
                    "type": "set-env-var",
                    "custom": "header.location | split(\"code=\") | last",
                    "action": "setto",
                    "value": "{{auth_code, local}}"
                }
            ]
        },
        {
            "_id": "21f26765-3577-42ff-93db-14af7184ea7e",
            "colId": "96ff2598-c93e-4171-b36a-57ea061c2fbc",
            "containerId": "671a350d-aa39-4575-bf02-b5985c56c753",
            "name": "131 /oauth/token Fail modified value client secret",
            "url": "{{auth_host}}/oauth/token",
            "method": "POST",
            "sortNum": 54531.3,
            "created": "2023-10-26T15:49:26.956Z",
            "modified": "2023-10-26T15:49:26.956Z",
            "headers": [
                {
                    "name": "Accept",
                    "value": "application/json"
                }
            ],
            "params": [],
            "body": {
                "type": "json",
                "raw": "{\n  \"code\": \"{{auth_code}}\",\n  \"redirect_uri\": \"{{redirect_uri}}\",\n  \"client_id\": \"{{client_id}}\",\n  \"client_secret\": \"{{client_secret}}x\",\n  \"grant_type\": \"\"\n}",
                "form": []
            },
            "tests": [
                {
                    "type": "res-code",
                    "custom": "",
                    "action": "equal",
                    "value": "401"
                }
            ]
        },
        {
            "_id": "a3dc3afa-3385-44e5-b9ea-d96d3b74bc79",
            "colId": "96ff2598-c93e-4171-b36a-57ea061c2fbc",
            "containerId": "671a350d-aa39-4575-bf02-b5985c56c753",
            "name": "/oauth/token Expect Success 5",
            "url": "{{auth_host}}/oauth/token",
            "method": "POST",
            "sortNum": 54531.3,
            "created": "2023-10-26T15:49:26.957Z",
            "modified": "2023-10-26T15:49:26.957Z",
            "headers": [
                {
                    "name": "Accept",
                    "value": "application/json"
                }
            ],
            "params": [],
            "body": {
                "type": "json",
                "raw": "{\n  \"code\": \"{{auth_code}}\",\n  \"redirect_uri\": \"{{redirect_uri}}\",\n  \"client_id\": \"{{client_id}}\",\n  \"client_secret\": \"{{client_secret}}\",\n  \"grant_type\": \"authorization_code\"\n}",
                "form": []
            },
            "tests": [
                {
                    "type": "res-code",
                    "custom": "",
                    "action": "equal",
                    "value": "200"
                },
                {
                    "type": "json-query",
                    "custom": "json.grant_type",
                    "action": "equal",
                    "value": "authorization_code"
                },
                {
                    "type": "json-query",
                    "custom": "json.token_type | lower",
                    "action": "equal",
                    "value": "bearer"
                },
                {
                    "type": "json-query",
                    "custom": "json.access_token | length",
                    "action": ">",
                    "value": "0"
                },
                {
                    "type": "json-query",
                    "custom": "json.refresh_token | length",
                    "action": ">",
                    "value": "0"
                }
            ]
        },
        {
            "_id": "7de3d1ba-e280-44d8-9fd8-14a9e4e2003d",
            "colId": "96ff2598-c93e-4171-b36a-57ea061c2fbc",
            "containerId": "671a350d-aa39-4575-bf02-b5985c56c753",
            "name": "/dialog/authorize  refresh transaction_id 5",
            "url": "{{auth_host}}/dialog/authorize?redirect_uri={{redirect_uri}}&response_type=code&client_id={{client_id}}&scope={{scopes}}",
            "method": "GET",
            "sortNum": 54531.3,
            "created": "2023-10-26T15:49:26.958Z",
            "modified": "2023-10-26T15:49:26.958Z",
            "headers": [
                {
                    "name": "Accept",
                    "value": "text/html"
                }
            ],
            "params": [
                {
                    "name": "redirect_uri",
                    "value": "{{redirect_uri}}",
                    "isPath": false
                },
                {
                    "name": "response_type",
                    "value": "code",
                    "isPath": false
                },
                {
                    "name": "client_id",
                    "value": "{{client_id}}",
                    "isPath": false
                },
                {
                    "name": "scope",
                    "value": "{{scopes}}",
                    "isPath": false
                }
            ],
            "tests": [
                {
                    "type": "res-code",
                    "custom": "",
                    "action": "equal",
                    "value": "200"
                },
                {
                    "type": "res-body",
                    "custom": "",
                    "action": "contains",
                    "value": "Resource Decision"
                },
                {
                    "type": "set-env-var",
                    "custom": "text | removeQuotes | split(\"name=_csrf\" | at(1) | split(\"value=\" | at(1) | split(\">\") | first ",
                    "action": "setto",
                    "value": "{{csrf_token, local}}"
                },
                {
                    "type": "set-env-var",
                    "custom": "text | removeQuotes | split(\"name=transaction_id\" | at(1) | split(\"value=\") | at(1) | split(\">\") | first",
                    "action": "setto",
                    "value": "{{transaction_id, local}}"
                }
            ]
        },
        {
            "_id": "c4b6cbbf-9c82-44c7-8223-6c50b20add92",
            "colId": "96ff2598-c93e-4171-b36a-57ea061c2fbc",
            "containerId": "671a350d-aa39-4575-bf02-b5985c56c753",
            "name": "/dialog/authorize/decision another auth code 5",
            "url": "{{auth_host}}/dialog/authorize/decision",
            "method": "POST",
            "sortNum": 54531.3,
            "created": "2023-10-26T15:49:26.959Z",
            "modified": "2023-10-26T15:49:26.959Z",
            "headers": [
                {
                    "name": "Accept",
                    "value": "text/html"
                }
            ],
            "params": [],
            "body": {
                "type": "formencoded",
                "raw": "",
                "form": [
                    {
                        "name": "transaction_id",
                        "value": "{{transaction_id}}"
                    },
                    {
                        "name": "_csrf",
                        "value": "{{csrf_token}}"
                    },
                    {
                        "name": "cancel",
                        "value": "Deny",
                        "isDisabled": true
                    }
                ]
            },
            "tests": [
                {
                    "type": "res-code",
                    "custom": "",
                    "action": "equal",
                    "value": "302"
                },
                {
                    "type": "custom-header",
                    "custom": "location | split(\"?\") | first",
                    "action": "equal",
                    "value": "{{redirect_uri}}"
                },
                {
                    "type": "custom-header",
                    "custom": "location",
                    "action": "contains",
                    "value": "code="
                },
                {
                    "type": "set-env-var",
                    "custom": "header.location | split(\"code=\") | last",
                    "action": "setto",
                    "value": "{{auth_code, local}}"
                }
            ]
        },
        {
            "_id": "33e3b9e4-976e-455e-a295-e17468ffca1d",
            "colId": "96ff2598-c93e-4171-b36a-57ea061c2fbc",
            "containerId": "671a350d-aa39-4575-bf02-b5985c56c753",
            "name": "/oauth/token Expect Success 4",
            "url": "{{auth_host}}/oauth/token",
            "method": "POST",
            "sortNum": 54531.3,
            "created": "2023-10-26T15:49:26.969Z",
            "modified": "2023-10-26T15:49:26.969Z",
            "headers": [
                {
                    "name": "Accept",
                    "value": "application/json"
                }
            ],
            "params": [],
            "body": {
                "type": "json",
                "raw": "{\n  \"code\": \"{{auth_code}}\",\n  \"redirect_uri\": \"{{redirect_uri}}\",\n  \"client_id\": \"{{client_id}}\",\n  \"client_secret\": \"{{client_secret}}\",\n  \"grant_type\": \"authorization_code\"\n}",
                "form": []
            },
            "tests": [
                {
                    "type": "res-code",
                    "custom": "",
                    "action": "equal",
                    "value": "200"
                },
                {
                    "type": "json-query",
                    "custom": "json.grant_type",
                    "action": "equal",
                    "value": "authorization_code"
                },
                {
                    "type": "json-query",
                    "custom": "json.token_type | lower",
                    "action": "equal",
                    "value": "bearer"
                },
                {
                    "type": "json-query",
                    "custom": "json.access_token | length",
                    "action": ">",
                    "value": "0"
                },
                {
                    "type": "json-query",
                    "custom": "json.refresh_token | length",
                    "action": ">",
                    "value": "0"
                }
            ]
        },
        {
            "_id": "ffe41fe2-078d-4bf6-91f2-e9781e473ed0",
            "colId": "96ff2598-c93e-4171-b36a-57ea061c2fbc",
            "containerId": "671a350d-aa39-4575-bf02-b5985c56c753",
            "name": "/dialog/authorize  refresh transaction_id 3",
            "url": "{{auth_host}}/dialog/authorize?redirect_uri={{redirect_uri}}&response_type=code&client_id={{client_id}}&scope={{scopes}}",
            "method": "GET",
            "sortNum": 54531.3,
            "created": "2023-10-26T15:49:26.970Z",
            "modified": "2023-10-26T15:49:26.970Z",
            "headers": [
                {
                    "name": "Accept",
                    "value": "text/html"
                }
            ],
            "params": [
                {
                    "name": "redirect_uri",
                    "value": "{{redirect_uri}}",
                    "isPath": false
                },
                {
                    "name": "response_type",
                    "value": "code",
                    "isPath": false
                },
                {
                    "name": "client_id",
                    "value": "{{client_id}}",
                    "isPath": false
                },
                {
                    "name": "scope",
                    "value": "{{scopes}}",
                    "isPath": false
                }
            ],
            "tests": [
                {
                    "type": "res-code",
                    "custom": "",
                    "action": "equal",
                    "value": "200"
                },
                {
                    "type": "res-body",
                    "custom": "",
                    "action": "contains",
                    "value": "Resource Decision"
                },
                {
                    "type": "set-env-var",
                    "custom": "text | removeQuotes | split(\"name=_csrf\" | at(1) | split(\"value=\" | at(1) | split(\">\") | first ",
                    "action": "setto",
                    "value": "{{csrf_token, local}}"
                },
                {
                    "type": "set-env-var",
                    "custom": "text | removeQuotes | split(\"name=transaction_id\" | at(1) | split(\"value=\") | at(1) | split(\">\") | first",
                    "action": "setto",
                    "value": "{{transaction_id, local}}"
                }
            ]
        },
        {
            "_id": "3e9b4905-6904-46fd-a794-fedc7da1d734",
            "colId": "96ff2598-c93e-4171-b36a-57ea061c2fbc",
            "containerId": "671a350d-aa39-4575-bf02-b5985c56c753",
            "name": "/dialog/authorize/decision Get another auth code 3",
            "url": "{{auth_host}}/dialog/authorize/decision",
            "method": "POST",
            "sortNum": 54531.3,
            "created": "2023-10-26T15:49:26.972Z",
            "modified": "2023-10-26T15:49:26.972Z",
            "headers": [
                {
                    "name": "Accept",
                    "value": "text/html"
                }
            ],
            "params": [],
            "body": {
                "type": "formencoded",
                "raw": "",
                "form": [
                    {
                        "name": "transaction_id",
                        "value": "{{transaction_id}}"
                    },
                    {
                        "name": "_csrf",
                        "value": "{{csrf_token}}"
                    },
                    {
                        "name": "cancel",
                        "value": "Deny",
                        "isDisabled": true
                    }
                ]
            },
            "tests": [
                {
                    "type": "res-code",
                    "custom": "",
                    "action": "equal",
                    "value": "302"
                },
                {
                    "type": "custom-header",
                    "custom": "location | split(\"?\") | first",
                    "action": "equal",
                    "value": "{{redirect_uri}}"
                },
                {
                    "type": "custom-header",
                    "custom": "location",
                    "action": "contains",
                    "value": "code="
                },
                {
                    "type": "set-env-var",
                    "custom": "header.location | split(\"code=\") | last",
                    "action": "setto",
                    "value": "{{auth_code, local}}"
                }
            ]
        },
        {
            "_id": "01311af4-9d6b-434d-a269-dd73b9bfa563",
            "colId": "96ff2598-c93e-4171-b36a-57ea061c2fbc",
            "containerId": "671a350d-aa39-4575-bf02-b5985c56c753",
            "name": "140 /oauth/token Fail Missing redirect uri",
            "url": "{{auth_host}}/oauth/token",
            "method": "POST",
            "sortNum": 54539.9,
            "created": "2023-10-26T15:49:26.941Z",
            "modified": "2023-10-26T15:49:26.941Z",
            "headers": [
                {
                    "name": "Accept",
                    "value": "application/json"
                }
            ],
            "params": [],
            "body": {
                "type": "json",
                "raw": "{\n  \"code\": \"{{auth_code}}\",\n  \"client_id\": \"{{client_id}}\",\n  \"client_secret\": \"{{client_secret}}\",\n  \"grant_type\": \"authorization_code\"\n}",
                "form": []
            },
            "tests": [
                {
                    "type": "res-code",
                    "custom": "",
                    "action": "equal",
                    "value": "403"
                }
            ]
        },
        {
            "_id": "b9ab6183-993e-4434-8671-aa64d6a56a1b",
            "colId": "96ff2598-c93e-4171-b36a-57ea061c2fbc",
            "containerId": "671a350d-aa39-4575-bf02-b5985c56c753",
            "name": "/dialog/authorize  refresh transaction_id 6",
            "url": "{{auth_host}}/dialog/authorize?redirect_uri={{redirect_uri}}&response_type=code&client_id={{client_id}}&scope={{scopes}}",
            "method": "GET",
            "sortNum": 54599.7,
            "created": "2023-10-26T15:49:26.960Z",
            "modified": "2023-10-26T15:49:26.960Z",
            "headers": [
                {
                    "name": "Accept",
                    "value": "text/html"
                }
            ],
            "params": [
                {
                    "name": "redirect_uri",
                    "value": "{{redirect_uri}}",
                    "isPath": false
                },
                {
                    "name": "response_type",
                    "value": "code",
                    "isPath": false
                },
                {
                    "name": "client_id",
                    "value": "{{client_id}}",
                    "isPath": false
                },
                {
                    "name": "scope",
                    "value": "{{scopes}}",
                    "isPath": false
                }
            ],
            "tests": [
                {
                    "type": "res-code",
                    "custom": "",
                    "action": "equal",
                    "value": "200"
                },
                {
                    "type": "res-body",
                    "custom": "",
                    "action": "contains",
                    "value": "Resource Decision"
                },
                {
                    "type": "set-env-var",
                    "custom": "text | removeQuotes | split(\"name=_csrf\" | at(1) | split(\"value=\" | at(1) | split(\">\") | first ",
                    "action": "setto",
                    "value": "{{csrf_token, local}}"
                },
                {
                    "type": "set-env-var",
                    "custom": "text | removeQuotes | split(\"name=transaction_id\" | at(1) | split(\"value=\") | at(1) | split(\">\") | first",
                    "action": "setto",
                    "value": "{{transaction_id, local}}"
                }
            ]
        },
        {
            "_id": "457473aa-28ee-4a65-9ee4-c1446bf8e9db",
            "colId": "96ff2598-c93e-4171-b36a-57ea061c2fbc",
            "containerId": "671a350d-aa39-4575-bf02-b5985c56c753",
            "name": "/dialog/authorize/decision another auth code 6",
            "url": "{{auth_host}}/dialog/authorize/decision",
            "method": "POST",
            "sortNum": 54633.9,
            "created": "2023-10-26T15:49:26.961Z",
            "modified": "2023-10-26T15:49:26.961Z",
            "headers": [
                {
                    "name": "Accept",
                    "value": "text/html"
                }
            ],
            "params": [],
            "body": {
                "type": "formencoded",
                "raw": "",
                "form": [
                    {
                        "name": "transaction_id",
                        "value": "{{transaction_id}}"
                    },
                    {
                        "name": "_csrf",
                        "value": "{{csrf_token}}"
                    },
                    {
                        "name": "cancel",
                        "value": "Deny",
                        "isDisabled": true
                    }
                ]
            },
            "tests": [
                {
                    "type": "res-code",
                    "custom": "",
                    "action": "equal",
                    "value": "302"
                },
                {
                    "type": "custom-header",
                    "custom": "location | split(\"?\") | first",
                    "action": "equal",
                    "value": "{{redirect_uri}}"
                },
                {
                    "type": "custom-header",
                    "custom": "location",
                    "action": "contains",
                    "value": "code="
                },
                {
                    "type": "set-env-var",
                    "custom": "header.location | split(\"code=\") | last",
                    "action": "setto",
                    "value": "{{auth_code, local}}"
                }
            ]
        },
        {
            "_id": "3cfe67c7-9d03-468f-b069-eaef662c8d09",
            "colId": "96ff2598-c93e-4171-b36a-57ea061c2fbc",
            "containerId": "671a350d-aa39-4575-bf02-b5985c56c753",
            "name": "141 /oauth/token Fail empty string  redirect uri",
            "url": "{{auth_host}}/oauth/token",
            "method": "POST",
            "sortNum": 54646.4,
            "created": "2023-10-26T15:49:26.945Z",
            "modified": "2023-10-26T15:49:26.945Z",
            "headers": [
                {
                    "name": "Accept",
                    "value": "application/json"
                }
            ],
            "params": [],
            "body": {
                "type": "json",
                "raw": "{\n  \"code\": \"{{auth_code}}\",\n  \"redirect_uri\": \"\",\n  \"client_id\": \"{{client_id}}\",\n  \"client_secret\": \"{{client_secret}}\",\n  \"grant_type\": \"authorization_code\"\n}",
                "form": []
            },
            "tests": [
                {
                    "type": "res-code",
                    "custom": "",
                    "action": "equal",
                    "value": "403"
                }
            ]
        },
        {
            "_id": "13b4f4a2-26f7-493e-b497-af1d3f203602",
            "colId": "96ff2598-c93e-4171-b36a-57ea061c2fbc",
            "containerId": "671a350d-aa39-4575-bf02-b5985c56c753",
            "name": "/dialog/authorize  refresh transaction_id 7",
            "url": "{{auth_host}}/dialog/authorize?redirect_uri={{redirect_uri}}&response_type=code&client_id={{client_id}}&scope={{scopes}}",
            "method": "GET",
            "sortNum": 54658.9,
            "created": "2023-10-26T15:49:26.962Z",
            "modified": "2023-10-26T15:49:26.962Z",
            "headers": [
                {
                    "name": "Accept",
                    "value": "text/html"
                }
            ],
            "params": [
                {
                    "name": "redirect_uri",
                    "value": "{{redirect_uri}}",
                    "isPath": false
                },
                {
                    "name": "response_type",
                    "value": "code",
                    "isPath": false
                },
                {
                    "name": "client_id",
                    "value": "{{client_id}}",
                    "isPath": false
                },
                {
                    "name": "scope",
                    "value": "{{scopes}}",
                    "isPath": false
                }
            ],
            "tests": [
                {
                    "type": "res-code",
                    "custom": "",
                    "action": "equal",
                    "value": "200"
                },
                {
                    "type": "res-body",
                    "custom": "",
                    "action": "contains",
                    "value": "Resource Decision"
                },
                {
                    "type": "set-env-var",
                    "custom": "text | removeQuotes | split(\"name=_csrf\" | at(1) | split(\"value=\" | at(1) | split(\">\") | first ",
                    "action": "setto",
                    "value": "{{csrf_token, local}}"
                },
                {
                    "type": "set-env-var",
                    "custom": "text | removeQuotes | split(\"name=transaction_id\" | at(1) | split(\"value=\") | at(1) | split(\">\") | first",
                    "action": "setto",
                    "value": "{{transaction_id, local}}"
                }
            ]
        },
        {
            "_id": "1c69ad6b-fa58-41ed-beed-bfd93df8b447",
            "colId": "96ff2598-c93e-4171-b36a-57ea061c2fbc",
            "containerId": "671a350d-aa39-4575-bf02-b5985c56c753",
            "name": "/dialog/authorize/decision another auth code 7",
            "url": "{{auth_host}}/dialog/authorize/decision",
            "method": "POST",
            "sortNum": 54696.4,
            "created": "2023-10-26T15:49:26.963Z",
            "modified": "2023-10-26T15:49:26.963Z",
            "headers": [
                {
                    "name": "Accept",
                    "value": "text/html"
                }
            ],
            "params": [],
            "body": {
                "type": "formencoded",
                "raw": "",
                "form": [
                    {
                        "name": "transaction_id",
                        "value": "{{transaction_id}}"
                    },
                    {
                        "name": "_csrf",
                        "value": "{{csrf_token}}"
                    },
                    {
                        "name": "cancel",
                        "value": "Deny",
                        "isDisabled": true
                    }
                ]
            },
            "tests": [
                {
                    "type": "res-code",
                    "custom": "",
                    "action": "equal",
                    "value": "302"
                },
                {
                    "type": "custom-header",
                    "custom": "location | split(\"?\") | first",
                    "action": "equal",
                    "value": "{{redirect_uri}}"
                },
                {
                    "type": "custom-header",
                    "custom": "location",
                    "action": "contains",
                    "value": "code="
                },
                {
                    "type": "set-env-var",
                    "custom": "header.location | split(\"code=\") | last",
                    "action": "setto",
                    "value": "{{auth_code, local}}"
                }
            ]
        },
        {
            "_id": "51a77952-236f-4f85-9dab-08e5968da255",
            "colId": "96ff2598-c93e-4171-b36a-57ea061c2fbc",
            "containerId": "671a350d-aa39-4575-bf02-b5985c56c753",
            "name": "142 /oauth/token Fail modified value redirect uri",
            "url": "{{auth_host}}/oauth/token",
            "method": "POST",
            "sortNum": 54734,
            "created": "2023-10-26T15:49:26.948Z",
            "modified": "2023-10-26T15:49:26.948Z",
            "headers": [
                {
                    "name": "Accept",
                    "value": "application/json"
                }
            ],
            "params": [],
            "body": {
                "type": "json",
                "raw": "{\n  \"code\": \"{{auth_code}}\",\n  \"redirect_uri\": \"{{redirect_uri}}/bad\",\n  \"client_id\": \"{{client_id}}\",\n  \"client_secret\": \"{{client_secret}}\",\n  \"grant_type\": \"authorization_code\"\n}",
                "form": []
            },
            "tests": [
                {
                    "type": "res-code",
                    "custom": "",
                    "action": "equal",
                    "value": "403"
                }
            ]
        },
        {
            "_id": "72e561d9-6683-44dd-a5eb-be24bdd710cf",
            "colId": "96ff2598-c93e-4171-b36a-57ea061c2fbc",
            "containerId": "671a350d-aa39-4575-bf02-b5985c56c753",
            "name": "/dialog/authorize  refresh transaction_id 8",
            "url": "{{auth_host}}/dialog/authorize?redirect_uri={{redirect_uri}}&response_type=code&client_id={{client_id}}&scope={{scopes}}",
            "method": "GET",
            "sortNum": 54800.5,
            "created": "2023-10-26T15:49:26.965Z",
            "modified": "2023-10-26T15:49:26.965Z",
            "headers": [
                {
                    "name": "Accept",
                    "value": "text/html"
                }
            ],
            "params": [
                {
                    "name": "redirect_uri",
                    "value": "{{redirect_uri}}",
                    "isPath": false
                },
                {
                    "name": "response_type",
                    "value": "code",
                    "isPath": false
                },
                {
                    "name": "client_id",
                    "value": "{{client_id}}",
                    "isPath": false
                },
                {
                    "name": "scope",
                    "value": "{{scopes}}",
                    "isPath": false
                }
            ],
            "tests": [
                {
                    "type": "res-code",
                    "custom": "",
                    "action": "equal",
                    "value": "200"
                },
                {
                    "type": "res-body",
                    "custom": "",
                    "action": "contains",
                    "value": "Resource Decision"
                },
                {
                    "type": "set-env-var",
                    "custom": "text | removeQuotes | split(\"name=_csrf\" | at(1) | split(\"value=\" | at(1) | split(\">\") | first ",
                    "action": "setto",
                    "value": "{{csrf_token, local}}"
                },
                {
                    "type": "set-env-var",
                    "custom": "text | removeQuotes | split(\"name=transaction_id\" | at(1) | split(\"value=\") | at(1) | split(\">\") | first",
                    "action": "setto",
                    "value": "{{transaction_id, local}}"
                }
            ]
        },
        {
            "_id": "ec2c2223-cfa1-4287-a73a-b247e3127869",
            "colId": "96ff2598-c93e-4171-b36a-57ea061c2fbc",
            "containerId": "671a350d-aa39-4575-bf02-b5985c56c753",
            "name": "/dialog/authorize/decision Use transaction_id twice (1 of 2)",
            "url": "{{auth_host}}/dialog/authorize/decision",
            "method": "POST",
            "sortNum": 54833.8,
            "created": "2023-10-26T15:49:26.966Z",
            "modified": "2023-10-26T15:49:26.966Z",
            "headers": [
                {
                    "name": "Accept",
                    "value": "text/html"
                }
            ],
            "params": [],
            "body": {
                "type": "formencoded",
                "raw": "",
                "form": [
                    {
                        "name": "transaction_id",
                        "value": "{{transaction_id}}"
                    },
                    {
                        "name": "_csrf",
                        "value": "{{csrf_token}}"
                    },
                    {
                        "name": "cancel",
                        "value": "Deny",
                        "isDisabled": true
                    }
                ]
            },
            "tests": [
                {
                    "type": "res-code",
                    "custom": "",
                    "action": "equal",
                    "value": "302"
                },
                {
                    "type": "custom-header",
                    "custom": "location | split(\"?\") | first",
                    "action": "equal",
                    "value": "{{redirect_uri}}"
                },
                {
                    "type": "custom-header",
                    "custom": "location",
                    "action": "contains",
                    "value": "code="
                },
                {
                    "type": "set-env-var",
                    "custom": "header.location | split(\"code=\") | last",
                    "action": "setto",
                    "value": "{{auth_code, local}}"
                }
            ]
        },
        {
            "_id": "dcf2f242-8386-4495-b3a9-2452768e5959",
            "colId": "96ff2598-c93e-4171-b36a-57ea061c2fbc",
            "containerId": "671a350d-aa39-4575-bf02-b5985c56c753",
            "name": "/dialog/authorize/decision Use transaction_id twice (2 of 2) Copy",
            "url": "{{auth_host}}/dialog/authorize/decision",
            "method": "POST",
            "sortNum": 54850.4,
            "created": "2023-10-26T15:49:26.967Z",
            "modified": "2023-10-26T15:49:26.967Z",
            "headers": [
                {
                    "name": "Accept",
                    "value": "text/html"
                }
            ],
            "params": [],
            "body": {
                "type": "formencoded",
                "raw": "",
                "form": [
                    {
                        "name": "transaction_id",
                        "value": "{{transaction_id}}"
                    },
                    {
                        "name": "_csrf",
                        "value": "{{csrf_token}}"
                    },
                    {
                        "name": "cancel",
                        "value": "Deny",
                        "isDisabled": true
                    }
                ]
            },
            "tests": [
                {
                    "type": "res-code",
                    "custom": "",
                    "action": "equal",
                    "value": "403"
                }
            ]
        },
        {
            "_id": "bc83fb8e-e54a-4542-9c87-677787db1a6c",
            "colId": "96ff2598-c93e-4171-b36a-57ea061c2fbc",
            "containerId": "671a350d-aa39-4575-bf02-b5985c56c753",
            "name": "/dialog/authorize  refresh transaction_id 9",
            "url": "{{auth_host}}/dialog/authorize?redirect_uri={{redirect_uri}}&response_type=code&client_id={{client_id}}&scope={{scopes}}",
            "method": "GET",
            "sortNum": 54867,
            "created": "2023-10-26T15:49:26.964Z",
            "modified": "2023-10-26T15:49:26.964Z",
            "headers": [
                {
                    "name": "Accept",
                    "value": "text/html"
                }
            ],
            "params": [
                {
                    "name": "redirect_uri",
                    "value": "{{redirect_uri}}",
                    "isPath": false
                },
                {
                    "name": "response_type",
                    "value": "code",
                    "isPath": false
                },
                {
                    "name": "client_id",
                    "value": "{{client_id}}",
                    "isPath": false
                },
                {
                    "name": "scope",
                    "value": "{{scopes}}",
                    "isPath": false
                }
            ],
            "tests": [
                {
                    "type": "res-code",
                    "custom": "",
                    "action": "equal",
                    "value": "200"
                },
                {
                    "type": "res-body",
                    "custom": "",
                    "action": "contains",
                    "value": "Resource Decision"
                },
                {
                    "type": "set-env-var",
                    "custom": "text | removeQuotes | split(\"name=_csrf\" | at(1) | split(\"value=\" | at(1) | split(\">\") | first ",
                    "action": "setto",
                    "value": "{{csrf_token, local}}"
                },
                {
                    "type": "set-env-var",
                    "custom": "text | removeQuotes | split(\"name=transaction_id\" | at(1) | split(\"value=\") | at(1) | split(\">\") | first",
                    "action": "setto",
                    "value": "{{transaction_id, local}}"
                }
            ]
        },
        {
            "_id": "c9266f94-f160-469d-aba5-12e447b9c8f7",
            "colId": "96ff2598-c93e-4171-b36a-57ea061c2fbc",
            "containerId": "671a350d-aa39-4575-bf02-b5985c56c753",
            "name": "/dialog/authorize/decision Fail no CSRF hash",
            "url": "{{auth_host}}/dialog/authorize/decision",
            "method": "POST",
            "sortNum": 54871.2,
            "created": "2023-10-26T15:49:26.968Z",
            "modified": "2023-10-26T15:49:26.968Z",
            "headers": [
                {
                    "name": "Accept",
                    "value": "text/html"
                }
            ],
            "params": [],
            "body": {
                "type": "formencoded",
                "raw": "",
                "form": [
                    {
                        "name": "transaction_id",
                        "value": "{{transaction_id}}"
                    },
                    {
                        "name": "_csrf",
                        "value": "{{csrf_token}}",
                        "isDisabled": true
                    },
                    {
                        "name": "cancel",
                        "value": "Deny",
                        "isDisabled": true
                    }
                ]
            },
            "tests": [
                {
                    "type": "res-code",
                    "custom": "",
                    "action": "equal",
                    "value": "302"
                },
                {
                    "type": "custom-header",
                    "custom": "location",
                    "action": "contains",
                    "value": "error=EBADCSRFTOKEN"
                },
                {
                    "type": "custom-header",
                    "custom": "location",
                    "action": "notcontains",
                    "value": "code="
                }
            ]
        }
    ]
}